#!/usr/bin/env bash

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "${SCRIPT_DIR}/lib/common.sh"

#
# Usage
#

usage() {
    cat <<EOF
Usage: git current-branch-name

Get the current branch name, even during an ongoing rebase.
This command works correctly in situations where 'git branch' shows
a detached HEAD state during interactive rebases.

Returns:
  - During rebase: the original branch name being rebased
  - Normal state: the current branch name

Examples:
  git current-branch-name
  branch=\$(git current-branch-name)

Options:
  -h, --help    Show this help message
EOF
    exit 0
}

#
# Main
#

main() {
    if [[ "${1:-}" == "-h" ]] || [[ "${1:-}" == "--help" ]]; then
        usage
    fi

    require_git_repo

    get_current_branch
}

main "$@"
